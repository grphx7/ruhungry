<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Choice Selector</title>
    <style>
        body {
            background-color: #333;
            color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
        }
        .container {
            background-color: #ccc;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            width: 300px;
            text-align: center;
        }
        .food-list {
            list-style: none;
            padding: 0;
        }
        .food-list li {
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        button {
            background-color: #444;
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #555;
        }
        .error {
            color: red;
        }
    </style>
    <script>
        let foodOptions = [
            { name: "Mcdonalds", points: 10 },
            { name: "Taco Bell", points: 8 },
            { name: "Sonic", points: 6 },
            { name: "Pizza Hut", points: 4 },
            { name: "Subway", points: 2 }
        ];

        let selectedChoices = [];

        function renderFoodOptions() {
            const list = document.getElementById("food-list");
            list.innerHTML = "";
            foodOptions.forEach((option, index) => {
                const li = document.createElement("li");
                li.innerHTML = `
                    <span>${option.name}</span>
                    <span>
                        <button onclick="selectChoice(${index})">Select</button>
                        ${!option.custom ? `<button onclick="removeOption(${index})">X</button>` : ""}
                    </span>
                `;
                list.appendChild(li);
            });
        }

        function selectChoice(index) {
            if (selectedChoices.includes(index)) {
                selectedChoices = selectedChoices.filter(i => i !== index);
            } else if (selectedChoices.length < 3) {
                selectedChoices.push(index);
            }
            updateSelectionNumbers();
        }

        function updateSelectionNumbers() {
            const listItems = document.querySelectorAll(".food-list li");
            listItems.forEach((li, index) => {
                const number = selectedChoices.indexOf(index) + 1;
                li.querySelector("span").innerText = number ? `${foodOptions[index].name} (${number})` : foodOptions[index].name;
            });
        }

        function removeOption(index) {
            foodOptions.splice(index, 1);
            selectedChoices = selectedChoices.filter(i => i !== index);
            renderFoodOptions();
            updateSelectionNumbers();
        }

        function addCustomOption() {
            const customInput = document.getElementById("custom-input");
            const customName = customInput.value.trim();
            if (customName) {
                foodOptions.push({ name: customName, points: 0, custom: true });
                customInput.value = "";
                renderFoodOptions();
            }
        }

        function submitChoices() {
            const pointsMap = selectedChoices.map((index, rank) => {
                const points = [4, 2, 1][rank] || 0;
                foodOptions[index].points += points;
                return { name: foodOptions[index].name, points: foodOptions[index].points };
            });
            alert("Choices submitted! Updated points: " + JSON.stringify(pointsMap));
        }

        window.onload = function () {
            const passcode = prompt("Enter passcode:");
            if (passcode) {
                try {
                    const decrypted = JSON.parse(atob(passcode));
                    if (Array.isArray(decrypted) && decrypted.every(item => item.name && typeof item.points === "number")) {
                        foodOptions = decrypted;
                    } else {
                        alert("Invalid passcode. Loading defaults.");
                    }
                } catch {
                    alert("Error decrypting passcode. Loading defaults.");
                }
            }
            renderFoodOptions();
        };
    </script>
</head>
<body>
    <div class="container">
        <h1>Food Choice Selector</h1>
        <ul id="food-list" class="food-list"></ul>
        <input type="text" id="custom-input" placeholder="Add custom food">
        <button onclick="addCustomOption()">Add</button>
        <button onclick="submitChoices()">Submit</button>
    </div>
</body>
</html>
